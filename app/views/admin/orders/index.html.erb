<%= render "admin/navbar" %>

<h1>Admin Orders</h1>

<table border="1" cellpadding="8" cellspacing="0">
  <tr>
    <th>ID</th>
    <th>User</th>
    <th>Total (₹)</th>
    <th>Status</th>
    <th>Change Status</th>
  </tr>

  <% @orders.each do |order| %>
    <tr>
      <td><%= order.id %></td>

      <td>
        <%= order.user&.email || "Guest" %>
      </td>

      <td>
        <strong>
          ₹ <%= number_with_delimiter(order.total_amount.to_i) %>
        </strong>
      </td>

      <td>
        <% case order.status %>
        <% when "placed" %>
          <span style="color: orange;"><%= order.status.capitalize %></span>
        <% when "confirmed" %>
          <span style="color: blue;"><%= order.status.capitalize %></span>
        <% when "shipped" %>
          <span style="color: purple;"><%= order.status.capitalize %></span>
        <% when "delivered" %>
          <span style="color: green; font-weight: bold;"><%= order.status.capitalize %></span>
        <% else %>
          <%= order.status.capitalize %>
        <% end %>
      </td>

      <td>
        <%= form_with url: admin_order_path(order), method: :patch, local: true do %>
          <%= select_tag :status,
              options_for_select(Order.statuses.keys.map { |s| [s.capitalize, s] }, order.status)
          %>
          <%= submit_tag "Update" %>
        <% end %>
      </td>
    </tr>
  <% end %>
</table>
